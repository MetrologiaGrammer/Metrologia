<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
	<title>GramEXPERT</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
	<link rel="stylesheet" href="assets/css/main.css"/>
</head>



<body class="is-preload">
<!-- Header -->
<header id="header">

	<div class="inner">
		<center><img id="imagenEquipo" style="width: 70%" alt="" class="aln-center" /></center>
	</div>
</header>
<!-- Main -->
<div id="main">
	<!-- One -->
	<section id="one">
		<header class="major">
			<h2 style="text-align: center">Consulta De Equipos</h2>
		</header>
		<div class="row gtr-uniform gtr-50">

			<div class="col-12 col-12-xsmall">
				<label  style="text-align: center">Ingrese referencia</label>
				<input type="text" name="emo-id" id="referencia" value="" placeholder="ID"/>
			</div>
			<div class="col-12 col-12-xsmall">
				<center><BUTTON onclick="Buscarequipo()" class="button primary"> Buscar Equipo</BUTTON></center>
			</div>
			<div class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px;">Id Referencia</label>
				<input type="text" name="demo-name" id="codigo" value="" placeholder="ID"disabled>
			</div>
			<div id="filaTipo" class="col-6 col-12-xsmall">
				<label  style="text-align: center;font-size: 18px;">Tipo</label>
				<input type="text" name="demo-name" id="tipo" value="" placeholder="TIPO"disabled>
			</div>
			<div id="filaSubtipo" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px;">Subtipo</label>
				<input type="text" name="demo-name" id="subtipo" value="" placeholder="SUB TIPO"disabled>
			</div>
			<div id="filaProceso" class="col-6 col-12-xsmall">
				<label  style="text-align: center;font-size: 18px;">Proceso</label>
				<input type="text" name="demo-name" id="proceso" value="" placeholder="PROCESO"disabled>
			</div>
			<div id="filaLinea" class="col-6 col-12-xsmall">
				<label  style="text-align: center;font-size: 18px">Linea</label>
				<input type="text" name="demo-name" id="linea" value="" placeholder="LINEA"disabled>
			</div>
			<div id="filaOperacion" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Operacion</label>
				<input type="text" name="demo-name" id="Operacion" value="" placeholder="OPERACION"disabled>
			</div>

			<div id="filaFechaverificacion" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Fecha de verificación</label>
				<input type="text" name="demo-email" id="fechacalibracion" value="" placeholder="FECHA DE VERIFICACION"disabled>
			</div>
			<div id="filaFechavencida" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Prox. fecha de verificación</label>
				<input type="text" name="demo-email" id="fechavencida" value="" placeholder="PROX. FECHA DE VERIFICACION"disabled>
			</div>
			<div id="filaFrecuencia" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Frecuencia</label>
				<input type="text" name="demo-email" id="frecuencia" value="" placeholder="FRECUENCIA"disabled>
			</div>
			<div id="filaResolucion" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Resolucion</label>
				<input type="text" name="demo-email" id="resolucion" value="" placeholder="RESOLUCION"disabled>
			</div>
			<div id="filaRango" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Rango</label>
				<input type="email" name="demo-email" id="rango" value="" placeholder="RANGO"disabled>
			</div>
			<div id="filaSerie" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Num.Serie</label>
				<input type="email" name="demo-email" id="numserie" value="" placeholder="NUM. SERIE"disabled>
			</div>
			<div id="filaParte" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Num.Parte</label>
				<input type="email" name="demo-email" id="numparte" value="" placeholder="NUM. PARTE"disabled>
			</div>
			<div id="fileStatus" class="col-6 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Status</label>
				<input type="email" name="demo-email" id="status" value="" placeholder="STATUS"disabled>
			</div>
			<div id="fileObservaciones" class="col-12 col-12-xsmall">
				<label style="text-align: center;font-size: 18px">Observaciones</label>
				<input type="email" name="demo-email" id="observaciones" value="" placeholder="OBSERVACIONES"disabled>
			</div>
		</div>
		<H2>REFERENCIA DE LA UBICACION EN FOTOS</H2>

		<center><img id="imagenUbicacion" src="images/pic2.jpg" alt="" style="width: 70%"/></center>
		<p></p>
		<div class="col-12 col-12-xsmall">
			<ul class="actions stacked" style="text-align: center">
				 <a class="button solid" onclick="desocultar()">Reportar</a></li>
			</ul>
		</div>

		<center><img id="carga" src="images/carga.gif" style="display: none;width: 50%;"></center>

		<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-body">
						<div id="contenidoReporte" style="display: none">
							<hr>
							<p>
								REPORTA EL PROBLEMA CON ALGUNAS SUGERENCIAS EN EL BOTON DESLIZABLE O
								DESCRIBELO EN EL CUADRO.
							</p>

							<div class="input-group mb-3">
								<span class="input-group-text" >REFERENCIA</span>
								<input type="text" id="referen" name="usuario" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
							</div>
							<div class="input-group mb-3">
								<span class="input-group-text" >NOMINA</span>
								<input type="text" id="nomina" name="usuario" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
							</div>
							<p></p>
							<div class="input-group mb-3">
								<span class="input-group-text" >REPORTE DE ETIQUETA</span>
								<select id="etiqueta" class="form-select" aria-label="Default select example">
									<option selected value="N/A">Open this select menu</option>
									<option value="ETIQUETA DAÑADA">ETIQUETA DAÑADA</option>
									<option value="NO TIENE ETIQUETA">NO TIENE ETIQUETA</option>
									<option value="NO SE LOGRA LEER EL QR">NO SE LOGRA LEER EL QR</option>
								</select>
							</div>
							<p></p>
							<div class="input-group mb-3">
								<span class="input-group-text" >REPORTAR EQUIPO</span>
								<select id="equipo" class="form-select" aria-label="Default select example">
									<option selected value="N/A">Open this select menu</option>
									<option value="EQUIPO DAÑADO">EQUIPO DAÑADO</option>
									<option value="CALIBRACION VENCIDA">CALIBRACION VENCIDA</option>
									<option value="EQUIPO EXTRAVIADO">EQUIPO EXTRAVIADO</option>
								</select>
							</div>
							<p></p>
							<div class="input-group mb-3">
								<span class="input-group-text" >DESCRIPCION DEL PROBLEMA</span>
								<input type="text" id="descproblema" name="usuario" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
							</div>
							<p></p>
							<div class="col-12 col-12-xsmall">
								<ul class="actions stacked" style="text-align: center">
									<li><a class="button solid" onclick="Reporte()">ENVIAR REPORTE</a>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>



	</section>
</div>
</section>


</div>

<!-- Footer -->
<footer id="footer">
	<div class="inner">
		<center>
		<ul class="icons">
			<li><a href="https://arketipo.mx/Metrologia/pantallaInicio/index.html" class="icon brands fa-dribbble">	INICIO<span class="label">Dribbble</span></a></li><br>
			<li><a href="https://arketipo.mx/Metrologia/estudios.html" class="icon brands fa-dribbble">	ESTUDIOS Y CERTIFICACIONES<span class="label">Dribbble</span></a></li><br>
			<li><a ONCLICK="mandar()" class="icon brands fa-dribbble">	ACTUALIZAR EQUIPOS<span class="label">Dribbble</span></a></li><br>

		</ul>
		</center>
	</div>
</footer>



<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.poptrox.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>

	function desocultar() {
		document.getElementById('contenidoReporte').style.display = 'block';
	}
	function getParameterByName(name) {
		name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
		var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
				results = regex.exec(location.search);
		var cadena = results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
		var arrTerminos = cadena.split(',');
		return arrTerminos[0];
	}


	buscarQR(getParameterByName("ID"));

	function buscarQR(id) {
		$.getJSON('https://arketipo.mx/Metrologia/inicio/dao/daoconsulta.php?referencia='+id, function (data) {


			document.getElementById("codigo").value = data.data[0].IdEquipo;
			document.getElementById("referen").value = data.data[0].IdEquipo;

			if (data.data[0].Tipo == "") {
				document.getElementById("filaTipo").style.display = 'none';
			} else {
				document.getElementById("tipo").value = data.data[0].Tipo;

				if (data.data[0].Tipo == "ESCALA") {
					document.getElementById("imagenEquipo").src = "images/ER-001.jpg";
				} else {
					document.getElementById("imagenEquipo").src = "images/" + data.data[0].IdEquipo + ".jpg"
				}
			}


			if (data.data[0].SubTipo == "") {
				document.getElementById("filaSerie").style.display = 'none';
			} else {
				document.getElementById("subtipo").value = data.data[0].SubTipo;
			}

			if (data.data[0].AreaProceso == "") {
				document.getElementById("filaProceso").style.display = 'none';
			} else {
				document.getElementById("proceso").value = data.data[0].AreaProceso;
			}

			if (data.data[0].AreaLinea == "") {
				document.getElementById("filaLinea").style.display = 'none';
			} else {
				document.getElementById("linea").value = data.data[0].AreaLinea;
			}


			if (data.data[0].AreaOperacion == "") {
				document.getElementById("filaOperacion").style.display = 'none';
			} else {
				document.getElementById("Operacion").value = data.data[0].AreaOperacion;
			}

			if (data.data[0].FechaInspeccion == "") {
				document.getElementById("filaFechaverificacion").style.display = 'none';
			} else {
				document.getElementById("fechacalibracion").value = data.data[0].FechaInspeccion;
			}


			if (data.data[0].FechaVencimiento == "") {
				document.getElementById("filaFechavencida").style.display = 'none';
			} else {
				document.getElementById("fechavencida").value = data.data[0].FechaVencimiento;
			}

			if (data.data[0].NumSerie == "") {
				document.getElementById("filaSerie").style.display = 'none';
			} else {
				document.getElementById("numserie").value = data.data[0].NumSerie;
			}

			if (data.data[0].NumParte == "") {
				document.getElementById("filaParte").style.display = 'none';
			} else {
				document.getElementById("numparte").value = data.data[0].NumParte;
			}

			if (data.data[0].Resolucion == "") {
				document.getElementById("filaResolucion").style.display = 'none';
			} else {
				document.getElementById("resolucion").value = data.data[0].Resolucion;
			}

			if (data.data[0].Rango == "") {
				document.getElementById("filaRango").style.display = 'none';
			} else {
				document.getElementById("rango").value = data.data[0].Rango;
			}

			if (data.data[0].CentroCosto == "") {
				document.getElementById("filaStatus").style.display = 'none';
			} else {
				document.getElementById("status").value = data.data[0].Status;
			}

			if (data.data[0].Observaciones == "") {
				document.getElementById("filaObservaciones").style.display = 'none';
			} else {
				document.getElementById("observaciones").value = data.data[0].Observaciones;
			}

			if (data.data[0].Frecuencia == "") {
				document.getElementById("filaFrecuencia").style.display = 'none';
			} else {
				document.getElementById("frecuencia").value = data.data[0].Frecuencia;
			}


		});
	}


	function Buscarequipo(){
		var Equipo;
		Equipo=document.getElementById("referencia").value;

		const chars =Equipo.split('-');

		var ref = chars[0];

		if (ref=="MPI" || ref == "MPL"){
			alert("Master");
		}else {
			$.getJSON('https://arketipo.mx/Metrologia/inicio/dao/daoconsulta.php?referencia=' + Equipo, function (data) {
				document.getElementById("codigo").value = data.data[0].IdEquipo;
				document.getElementById("referen").value = data.data[0].IdEquipo;


				if (data.data[0].Tipo == "") {
					document.getElementById("filaTipo").style.display = 'none';
				} else {
					document.getElementById("tipo").value = data.data[0].Tipo;

					if (data.data[0].Tipo == "ESCALA") {
						document.getElementById("imagenEquipo").src = "images/ER-001.jpg";
					} else {
						document.getElementById("imagenEquipo").src = "images/" + data.data[0].IdEquipo + ".jpg"
					}
				}


				if (data.data[0].SubTipo == "") {
					document.getElementById("filaSerie").style.display = 'none';
				} else {
					document.getElementById("subtipo").value = data.data[0].SubTipo;
				}


				if (data.data[0].AreaProceso == "") {
					document.getElementById("filaProceso").style.display = 'none';
				} else {
					document.getElementById("proceso").value = data.data[0].AreaProceso;
				}


				if (data.data[0].AreaLinea == "") {
					document.getElementById("filaLinea").style.display = 'none';
				} else {
					document.getElementById("linea").value = data.data[0].AreaLinea;
				}


				if (data.data[0].AreaOperacion == "") {
					document.getElementById("filaOperacion").style.display = 'none';
				} else {
					document.getElementById("Operacion").value = data.data[0].AreaOperacion;
				}

				if (data.data[0].FechaInspeccion == "") {
					document.getElementById("filaFechaverificacion").style.display = 'none';
				} else {
					document.getElementById("fechacalibracion").value = data.data[0].FechaInspeccion;
				}


				if (data.data[0].FechaVencimiento == "") {
					document.getElementById("filaFechavencida").style.display = 'none';
				} else {
					document.getElementById("fechavencida").value = data.data[0].FechaVencimiento;
				}


				if (data.data[0].NumSerie == "") {
					document.getElementById("filaSerie").style.display = 'none';
				} else {
					document.getElementById("numserie").value = data.data[0].NumSerie;
				}

				if (data.data[0].NumParte == "") {
					document.getElementById("filaParte").style.display = 'none';
				} else {
					document.getElementById("numparte").value = data.data[0].NumParte;
				}

				if (data.data[0].Resolucion == "") {
					document.getElementById("filaResolucion").style.display = 'none';
				} else {
					document.getElementById("resolucion").value = data.data[0].Resolucion;
				}

				if (data.data[0].Rango == "") {
					document.getElementById("filaRango").style.display = 'none';
				} else {
					document.getElementById("rango").value = data.data[0].Rango;
				}

				if (data.data[0].CentroCosto == "") {
					document.getElementById("filaStatus").style.display = 'none';
				} else {
					document.getElementById("status").value = data.data[0].Status;
				}

				if (data.data[0].Observaciones == "") {
					document.getElementById("filaObservaciones").style.display = 'none';
				} else {
					document.getElementById("observaciones").value = data.data[0].Observaciones;
				}

				if (data.data[0].Frecuencia == "") {
					document.getElementById("filaFrecuencia").style.display = 'none';
				} else {
					document.getElementById("frecuencia").value = data.data[0].Frecuencia;
				}


			});
		}
			consultaFoto(Equipo);





	}
	function consultaFoto(Equipo){
		console.log('https://arketipo.mx/Metrologia/inicio/dao/daoConsultafoto.php?idreferencia='+Equipo);
		$.getJSON('https://arketipo.mx/Metrologia/inicio/dao/daoConsultafoto.php?idreferencia='+Equipo, function (data) {
			document.getElementById("imagenUbicacion").src = "dao/imagenActualizacion/"+data.data[0].IdImagen+".png";
			document.getElementById("proceso").value = data.data[0].AreaProceso;
			document.getElementById("linea").value = data.data[0].Linea;
			//document.getElementById("operacion").value = data.data[0].Operacion;
		});
	}





	function mandar() {
		window.location = "https://arketipo.mx/Metrologia/inicio/actualizarEquipo.php?ID="+document.getElementById("codigo").value;
	}

	function Reporte(){



		var nomina;
		var Retiqueta;
		var Requipo;
		var Descripcion;
		var Referencia;

		nomina = document.getElementById("nomina").value;
		Retiqueta = document.getElementById("etiqueta").value;
		Requipo = document.getElementById("equipo").value;
		Descripcion = document.getElementById("descproblema").value;
		Referencia = document.getElementById("referencia").value;
		if (nomina !=" "){

			document.getElementById("carga").style.display="block";
			document.getElementById("contenidoReporte").style.display="none";



		const data = new FormData();

		data.append('nomina',nomina);
		data.append('Retiqueta', Retiqueta);
		data.append('Requipo', Requipo);
		data.append('Descripcion', Descripcion);
		data.append('Referencia', Referencia);

		fetch('https://arketipo.mx//MailerMetrologia.php', {
			method: 'POST',
			body: data
		})
				.then(function (response) {
					if (response.ok) {
						document.getElementById("carga").style.display="none";
						document.getElementById("contenidoReporte").style.display="block";
						document.getElementById("nomina").value ="";
					} else {
						throw "Error";
					}
				})
				.then(function (texto) {
					console.log(texto);
				})
				.catch(function (err) {
					console.log(err);
				});

		} else {
			Swal.fire({
				icon: "error",
				title: "Campo nomina vacio",
				showConfirmButton: false,
				timer: 1500
			});
		}


	}

</script>

</body>
</html>